# https://hub.docker.com/r/jenkins/jenkins/
# https://github.com/jenkinsci/docker/blob/master/README.md
version: '3'

services:

  jenkins:
    container_name: ${PROJECT_NAME}
    build:
      context: ./
      dockerfile: Dockerfile
    volumes:
      # https://devopscube.com/run-docker-in-docker/#:~:text=To%20run%20docker%20inside%20docker,sock%20as%20a%20volume.&text=Just%20a%20word%20of%20caution,privileges%20over%20your%20docker%20daemon.
#      - /var/run/docker.sock:/var/run/docker.sock
      # Map jenkins_home to keep all data, reports, etc
      - ./jenkins_home:/var/jenkins_home
      # Map the behat folder
#      - ../behat:/behat
    environment:
      # Disable setup wizard.
      JAVA_OPTS: -Djenkins.install.runSetupWizard=false
    ports:
      - '8080:8080'
      - '50000:50000'

  browser:
    # https://github.com/SeleniumHQ/docker-selenium
    # Image to debug with vnc port 5900
    # Password: secret
#    image: selenium/standalone-chrome:beta
    image: selenium/standalone-chrome-debug:3.141.59-xenon
    shm_size: 2gb
#    depends_on:
#      - selenium-hub
    container_name: ${PROJECT_NAME}_browser
    ports:
      - '4444:4444'
      - '5900:5900'
