<?php

/**
 * @file
 * Contains hook implementations for Alshaya Product Zoom module.
 */

/**
 * Implements hook_theme().
 */
function alshaya_product_zoom_theme($existing, $type, $theme, $path) {
  return [
    'product_zoom' => [
      'variables' => [
        'mainImage' => '',
        'thumbnails' => '',
        'pager_flag' => '',
        'properties' => '',
        'labels' => '',
        'image_slider_position_pdp' => '',
      ],
      'template' => 'product_zoom',
    ],
    'alshaya_magazine' => [
      'variables' => [
        'mainImage' => '',
        'thumbnails' => '',
        'pager_flag' => '',
        'properties' => '',
        'labels' => '',
        'image_slider_position_pdp' => '',
      ],
      'template' => 'alshaya_magazine',
    ],
  ];
}

/**
 * Implements hook_preprocess_node().
 */
function alshaya_product_zoom_preprocess_node(&$variables) {
  $skuManager = \Drupal::service('alshaya_acm_product.skumanager');
  // Add PDP slider position config to variable so it is available in themes.
  $pdp_image_slider_position = '';
  if (isset($variables['node']) && $variables['node']->bundle() === 'acq_product') {
    $pdp_image_slider_position = $skuManager->getImageSliderPosition($variables['node']);
  }
  $variables['image_slider_position_pdp'] = 'slider-position-' . $pdp_image_slider_position;
  // Add PDP slider position config to drupalSettings so we can use it in JS.
  $variables['#attached']['drupalSettings']['alshaya_white_label']['image_slider_position_pdp'] = 'slider-position-' . $pdp_image_slider_position;
}
